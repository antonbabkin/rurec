---

title: InfoGroup data


keywords: fastai
sidebar: home_sidebar

summary: "Process and prepare InfoGroup dataset."
description: "Process and prepare InfoGroup dataset."
nb_path: "nbs/infogroup.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/infogroup.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/miniconda3/envs/rurec/lib/python3.8/site-packages/fastparquet/encoding.py:222: NumbaDeprecationWarning: The &#39;numba.jitclass&#39; decorator has moved to &#39;numba.experimental.jitclass&#39; to better reflect the experimental nature of the functionality. Please update your imports to accommodate this change and see http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#change-of-jitclass-location for the time frame.
  Numpy8 = numba.jitclass(spec8)(NumpyIO)
/opt/miniconda3/envs/rurec/lib/python3.8/site-packages/fastparquet/encoding.py:224: NumbaDeprecationWarning: The &#39;numba.jitclass&#39; decorator has moved to &#39;numba.experimental.jitclass&#39; to better reflect the experimental nature of the functionality. Please update your imports to accommodate this change and see http://numba.pydata.org/numba-doc/latest/reference/deprecation.html#change-of-jitclass-location for the time frame.
  Numpy32 = numba.jitclass(spec32)(NumpyIO)
/opt/miniconda3/envs/rurec/lib/python3.8/site-packages/fastparquet/dataframe.py:5: FutureWarning: pandas.core.index is deprecated and will be removed in a future version.  The public classes are available in the top-level namespace.
  from pandas.core.index import CategoricalIndex, RangeIndex, Index, MultiIndex
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;infogroup/schema&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">/</span><span class="s1">&#39;processing.log&#39;</span><span class="p">,</span> 
                    <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1">:</span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1">:</span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resources</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="s1">&#39;infogroup/schema&#39;</span><span class="p">,</span> <span class="s1">&#39;/InfoGroup/data/processed/schema.json&#39;</span><span class="p">,</span> <span class="s1">&#39;Processed InfoGroup data, schema&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data_years</span><span class="p">:</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;infogroup/csv/</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;/InfoGroup/data/processed/</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Processed InfoGroup data, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">, CSV format&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;infogroup/pq/</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;/InfoGroup/data/processed/</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">.pq&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Processed InfoGroup data, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">, parquet format&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;infogroup/orig/</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;/InfoGroup/data/original/raw/</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">_Business_Academic_QCQ.csv&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Original unprocessed InfoGroup data, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resources</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="s1">&#39;infogroup/full&#39;</span><span class="p">,</span> <span class="s1">&#39;/InfoGroup/data/processed/full.pq&#39;</span><span class="p">,</span> <span class="s1">&#39;Processed InfoGroup data, all years, partitioned parquet&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resource &#34;infogroup/full&#34; added to registry.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clear-and-validate-raw-data">Clear and validate raw data<a class="anchor-link" href="#Clear-and-validate-raw-data"> </a></h2><ul>
<li>Change "latin-1" encoding to "utf-8", remove double quotes around values.</li>
<li>Remove double quotes around every value.</li>
<li>Rename columns to ALL_CAPS.</li>
<li>In 2009: pad string fields with zeroes.</li>
<li>Validate values format, replace errors with missing values.</li>
</ul>
<h3 id="Future-work">Future work<a class="anchor-link" href="#Future-work"> </a></h3><ul>
<li>Correct 2-digit state part of the FIPS code.</li>
<li>Correct missing CBSA code and CBSA level, mainly in 2009.</li>
<li>add indicator variables for different samples (random, WI, FAI, ...) to be used as parquet partitions to allow quick read of data subsets</li>
<li>put meaningfult labels to categoricals ("1-5" instead if "A" etc).<ul>
<li>This will be tricky for POPULATION_CODE that changes coding between 2015 and 2016</li>
</ul>
</li>
<li>make up and add enum constraints for TITLE_CODE and CALL_STATUS_CODE</li>
<li>add logging of errors to a file</li>
<li>if categoricals are worthy on fields with large number of unique values, possible unknown a priori, such as city or NAICS, then they should be applied. care should be taken because set of unique values can vary between years, and it might create problems when merging.</li>
<li>validations:<ul>
<li>codes are valid (i.e. can be found in lookup tables) for fields such as SIC, NAICS, FIPS, CBSA_CODE etc.</li>
<li>geo variable consistency: CBSA_LEVEL vs CBSA_CODE, lon-lat, nesting of areas</li>
</ul>
</li>
<li>few variables have many values like "00000", those should possibly be replaced with np.nan<ul>
<li>subsidiary_number, parent_number, site_number, census_tract, csa_code, maybe others</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convert_schema" class="doc_header"><code>convert_schema</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convert_schema</code>(<strong><code>datapackage_schema_path</code></strong>)</p>
</blockquote>
<p>Convert old datapackage schema.json into a new file, to be used for data validation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_schema" class="doc_header"><code>get_schema</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_schema</code>(<strong><code>field_name</code></strong>=<em><code>None</code></em>, <strong><code>year</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Flexible function to get dataset schema.</p>
<p>With no parameters, return full list of field dictionaries.
With <code>year</code>, restrict to fields present in that year.
With <code>field_name</code>, return dictionary for specific field (<code>year</code> is ignored in this case).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pad_with_zeroes" class="doc_header"><code>pad_with_zeroes</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L111" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pad_with_zeroes</code>(<strong><code>df</code></strong>, <strong><code>schema_fields</code></strong>)</p>
</blockquote>
<p>Prepend string column values with zeroes to have constant width.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate_raw_strings" class="doc_header"><code>validate_raw_strings</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L118" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate_raw_strings</code>(<strong><code>df</code></strong>, <strong><code>schema_fields</code></strong>)</p>
</blockquote>
<p>Validate values in raw InfoGroup data according to string constraints.
Return list of dicts of invalid values.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convert_dtypes" class="doc_header"><code>convert_dtypes</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convert_dtypes</code>(<strong><code>df</code></strong>, <strong><code>schema_fields</code></strong>)</p>
</blockquote>
<p>Inplace convert string columns to appropriate types.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate_raw_numbers" class="doc_header"><code>validate_raw_numbers</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L182" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate_raw_numbers</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Validate values in raw InfoGroup data according to numerical constraints.
Return list of dicts of invalid values.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="replace_invalid" class="doc_header"><code>replace_invalid</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>replace_invalid</code>(<strong><code>df</code></strong>, <strong><code>invalid_list</code></strong>, <strong><code>replacement</code></strong>=<em><code>nan</code></em>)</p>
</blockquote>
<p>Replace invalid values.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">convert_schema</span><span class="p">(</span><span class="s1">&#39;/InfoGroup/data/original/raw/datapackage_schema.json&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># are not includes in the full parquet dataset</span>
<span class="n">shared_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
               <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;infogroup/schema&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">())[</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span>
               <span class="k">if</span> <span class="p">(</span><span class="mi">1997</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;POPULATION_CODE&#39;</span><span class="p">])]</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">data_years</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Processing started for year </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">sch</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;infogroup/schema&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">())</span>
    <span class="n">sch</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sch</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">]]</span>
    
    <span class="c1"># POPULATION_CODE has different values in 2016 and 2017</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">2016</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sch</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;POPULATION_CODE&#39;</span><span class="p">:</span>
                <span class="n">f</span><span class="p">[</span><span class="s1">&#39;enum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;0123456789&#39;</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;infogroup/orig/</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;original_name&#39;</span><span class="p">]:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sch</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">2009</span><span class="p">:</span>
        <span class="n">pad_with_zeroes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sch</span><span class="p">)</span>

    <span class="n">invalid_str</span> <span class="o">=</span> <span class="n">validate_raw_strings</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sch</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">invalid_str</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">replace_invalid</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">invalid_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Very many invalid_str values: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">invalid_str</span><span class="p">)</span><span class="si">}</span><span class="s1">, processing aborted&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">invalid_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
        <span class="k">continue</span> <span class="c1"># skip to next year</span>

    <span class="n">convert_dtypes</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sch</span><span class="p">)</span>

    <span class="n">invalid_num</span> <span class="o">=</span> <span class="n">validate_raw_numbers</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">invalid_num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">replace_invalid</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">invalid_num</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Very many invalid_num values: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">invalid_num</span><span class="p">)</span><span class="si">}</span><span class="s1">, processing aborted&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">invalid_num</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
        <span class="k">continue</span> <span class="c1"># skip to next year</span>
        

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">shared_cols</span><span class="p">]</span>
    <span class="n">year_partition_path_template</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;infogroup/full&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/YEAR=</span><span class="si">{y}</span><span class="s1">&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">year_partition_path_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">year</span><span class="p">),</span> <span class="s1">&#39;fastparquet&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partition_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STATE&#39;</span><span class="p">])</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Processing finished for year </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
    
<span class="n">pfm</span> <span class="o">=</span> <span class="n">fastparquet</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">year_partition_path_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data_years</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_df" class="doc_header"><code>get_df</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L206" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_df</code>(<strong><code>years</code></strong>=<em><code>None</code></em>, <strong><code>cols</code></strong>=<em><code>None</code></em>, <strong><code>states</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Return one year of InfoGroup data with appropriate data types.
Subset of columns can be loaded by passing list to <code>cols</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Descriptive-summary-statistics">Descriptive summary statistics<a class="anchor-link" href="#Descriptive-summary-statistics"> </a></h1><p>Missing counts are reported as captured by <code>isna()</code> method. This will include empty strings from raw CSV for string dtype.</p>
<p>Some variables also have a special value such as "000" which is reported separately. These special values are not documented, and so are discovered by inspection.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="describe_variable" class="doc_header"><code>describe_variable</code><a href="https://github.com/antonbabkin/rurec/tree/master/rurec/infogroup.py#L221" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>describe_variable</code>(<strong><code>col</code></strong>, <strong><code>df</code></strong>=<em><code>None</code></em>, <strong><code>distribution</code></strong>=<em><code>False</code></em>, <strong><code>count_values</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>
<p>Return summary statistics of <code>col</code> for all years of data.
Returned object is <code>pandas.io.formats.style.Styler</code> styled for notebook display (number formats).</p>
<p>Dataframe is read from disk unless given in <code>df</code>.
Distribution moments are reported by setting <code>distribution</code> to True.
Counts of values specified in <code>count_values</code> are reported.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>COMPANY</strong>: Name of business - will have blanks</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;COMPANY&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary data-open="Hide Output" data-close="Show Output"></summary>
        <summary></summary>
        
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
</style><table id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Total</th>        <th class="col_heading level0 col1" >Not missing</th>        <th class="col_heading level0 col2" >Missing</th>        <th class="col_heading level0 col3" >Unique</th>    </tr>    <tr>        <th class="index_name level0" >YEAR</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row0" class="row_heading level0 row0" >1997</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row0_col0" class="data row0 col0" >226,125</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row0_col1" class="data row0 col1" >219,120</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row0_col2" class="data row0 col2" >7,005</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row0_col3" class="data row0 col3" >164,147</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row1" class="row_heading level0 row1" >1998</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row1_col0" class="data row1 col0" >216,979</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row1_col1" class="data row1 col1" >210,935</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row1_col2" class="data row1 col2" >6,044</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row1_col3" class="data row1 col3" >160,412</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row2" class="row_heading level0 row2" >1999</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row2_col0" class="data row2 col0" >220,630</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row2_col1" class="data row2 col1" >214,267</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row2_col2" class="data row2 col2" >6,363</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row2_col3" class="data row2 col3" >163,418</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row3" class="row_heading level0 row3" >2000</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row3_col0" class="data row3 col0" >222,964</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row3_col1" class="data row3 col1" >215,854</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row3_col2" class="data row3 col2" >7,110</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row3_col3" class="data row3 col3" >164,760</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row4" class="row_heading level0 row4" >2001</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row4_col0" class="data row4 col0" >252,907</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row4_col1" class="data row4 col1" >242,548</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row4_col2" class="data row4 col2" >10,359</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row4_col3" class="data row4 col3" >183,532</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row5" class="row_heading level0 row5" >2002</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row5_col0" class="data row5 col0" >252,853</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row5_col1" class="data row5 col1" >245,471</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row5_col2" class="data row5 col2" >7,382</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row5_col3" class="data row5 col3" >186,710</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row6" class="row_heading level0 row6" >2003</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row6_col0" class="data row6 col0" >250,015</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row6_col1" class="data row6 col1" >242,903</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row6_col2" class="data row6 col2" >7,112</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row6_col3" class="data row6 col3" >184,477</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row7" class="row_heading level0 row7" >2004</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row7_col0" class="data row7 col0" >250,556</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row7_col1" class="data row7 col1" >243,392</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row7_col2" class="data row7 col2" >7,164</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row7_col3" class="data row7 col3" >184,727</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row8" class="row_heading level0 row8" >2005</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row8_col0" class="data row8 col0" >267,922</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row8_col1" class="data row8 col1" >259,607</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row8_col2" class="data row8 col2" >8,315</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row8_col3" class="data row8 col3" >196,397</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row9" class="row_heading level0 row9" >2006</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row9_col0" class="data row9 col0" >266,496</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row9_col1" class="data row9 col1" >257,102</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row9_col2" class="data row9 col2" >9,394</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row9_col3" class="data row9 col3" >194,446</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row10" class="row_heading level0 row10" >2007</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row10_col0" class="data row10 col0" >277,547</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row10_col1" class="data row10 col1" >267,089</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row10_col2" class="data row10 col2" >10,458</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row10_col3" class="data row10 col3" >201,384</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row11" class="row_heading level0 row11" >2008</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row11_col0" class="data row11 col0" >276,167</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row11_col1" class="data row11 col1" >263,310</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row11_col2" class="data row11 col2" >12,857</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row11_col3" class="data row11 col3" >198,438</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row12" class="row_heading level0 row12" >2009</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row12_col0" class="data row12 col0" >273,936</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row12_col1" class="data row12 col1" >263,656</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row12_col2" class="data row12 col2" >10,280</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row12_col3" class="data row12 col3" >194,517</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row13" class="row_heading level0 row13" >2010</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row13_col0" class="data row13 col0" >283,902</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row13_col1" class="data row13 col1" >266,664</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row13_col2" class="data row13 col2" >17,238</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row13_col3" class="data row13 col3" >198,476</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row14" class="row_heading level0 row14" >2011</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row14_col0" class="data row14 col0" >266,146</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row14_col1" class="data row14 col1" >249,972</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row14_col2" class="data row14 col2" >16,174</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row14_col3" class="data row14 col3" >183,112</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row15" class="row_heading level0 row15" >2012</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row15_col0" class="data row15 col0" >284,668</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row15_col1" class="data row15 col1" >265,793</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row15_col2" class="data row15 col2" >18,875</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row15_col3" class="data row15 col3" >189,659</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row16" class="row_heading level0 row16" >2013</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row16_col0" class="data row16 col0" >301,143</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row16_col1" class="data row16 col1" >280,878</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row16_col2" class="data row16 col2" >20,265</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row16_col3" class="data row16 col3" >198,093</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row17" class="row_heading level0 row17" >2014</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row17_col0" class="data row17 col0" >304,469</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row17_col1" class="data row17 col1" >285,416</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row17_col2" class="data row17 col2" >19,053</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row17_col3" class="data row17 col3" >198,093</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row18" class="row_heading level0 row18" >2015</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row18_col0" class="data row18 col0" >296,641</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row18_col1" class="data row18 col1" >279,353</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row18_col2" class="data row18 col2" >17,288</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row18_col3" class="data row18 col3" >193,863</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row19" class="row_heading level0 row19" >2016</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row19_col0" class="data row19 col0" >300,708</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row19_col1" class="data row19 col1" >280,176</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row19_col2" class="data row19 col2" >20,532</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row19_col3" class="data row19 col3" >192,888</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row20" class="row_heading level0 row20" >2017</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row20_col0" class="data row20 col0" >283,244</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row20_col1" class="data row20 col1" >263,113</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row20_col2" class="data row20 col2" >20,131</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row20_col3" class="data row20 col3" >183,951</td>
            </tr>
            <tr>
                        <th id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3level0_row21" class="row_heading level0 row21" >All</th>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row21_col0" class="data row21 col0" >5,576,018</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row21_col1" class="data row21 col1" >5,316,619</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row21_col2" class="data row21 col2" >259,399</td>
                        <td id="T_f14f1450_ed30_11ea_b75a_bdba5d2d06d3row21_col3" class="data row21 col3" >585,016</td>
            </tr>
    </tbody></table>
</div>

</div>

</div>
</div>

    </details>
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;collapse output&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary data-open="Hide Output" data-close="Show Output"></summary>
        <summary></summary>
        
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>collapse output
</pre>
</div>
</div>

</div>
</div>

    </details>
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;collapse input&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>collapse input
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open>
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;collapse input open&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>collapse input open
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ADDRESS</strong>: Historical address</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;ADDRESS&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>CITY</strong>: Historical address city</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;CITY&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>STATE</strong>: Historical address state</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;STATE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;STATE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ZIP</strong>: Historical address zip code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;ZIP&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ZIP4</strong>: Historical address zip code zip + 4</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;ZIP4&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>COUNTY_CODE</strong>: County code based upon location address/zip4 (postal)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;COUNTY_CODE&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>AREA_CODE</strong>: Area code of business</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;AREA_CODE&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ID_CODE</strong>: The code that indentifies the yellow page listing is for a business or for an individual.  this field helps clients indentify if the record represents a professional indivisual versus a firm record.<br>
Value labels:<br>
1: Individual<br>
2: Firm</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;ID_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;ID_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EMPLOYEES_CODE</strong>: Code indicating range of employees at that location<br>
Value labels:<br>
A: 1-4<br>
B: 5-9<br>
C: 10-19<br>
D: 20-49<br>
E: 50-99<br>
F: 100-249<br>
G: 250-499<br>
H: 500-999<br>
I: 1000-4999<br>
J: 5000-9999<br>
K: 10000-</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;EMPLOYEES_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;EMPLOYEES_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SALES_CODE</strong>: Corporate sales volume code (ranges) represents the total sales company wide<br>
Value labels:<br>
A: 1-499<br>
B: 500-999<br>
C: 1000-2499<br>
D: 2500-4999<br>
E: 5000-9999<br>
F: 10000-19999<br>
G: 20000-49999<br>
H: 50000-99999<br>
I: 100000-499999<br>
J: 500000-999999<br>
K: 1000000+</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SALES_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;SALES_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC</strong>: This field contains the 6-digit sic code for the businesss primary activity</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC_DESC</strong>: The desciption for the sic code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>NAICS</strong>: The desciption for the primary naics code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;NAICS&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>NAICS_DESC</strong>: The desciption for the naics code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;NAICS_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC0</strong>: A line of business that company engages in</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC0&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC0_DESC</strong>: The desciption for the sic code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC0_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC1</strong>: This field identifies an additional activity of the business.  if there is no additional activity, this field will be blank.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC1&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC1_DESC</strong>: The desciption for the secondary sic code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC1_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC2</strong>: This field identifies an additional activity of the business.  if there is no additional activity, this field will be blank.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC2&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC2_DESC</strong>: The desciption for the secondary sic code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC2_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC3</strong>: This field identifies an additional activity of the business.  if there is no additional activity, this field will be blank.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC3&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC3_DESC</strong>: The desciption for the secondary sic code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC3_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC4</strong>: This field identifies an additional activity of the business.  if there is no additional activity, this field will be blank.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC4&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SIC4_DESC</strong>: The desciption for the secondary sic code</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SIC4_DESC&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>YEAR</strong>: Year of data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;YEAR&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>YP_CODE</strong>: A numeric value assigned to yellow page heading for the sic</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;YP_CODE&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EMPLOYEES</strong>: Number of employees at that location, could be modeled</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;EMPLOYEES&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SALES</strong>: Sales volume at that location (in thousands)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SALES&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>BUSINESS_STATUS</strong>: Indicates if record is hq, sub, or branch<br>
Value labels:<br>
1: headquarters<br>
2: branch<br>
3: subsidiary<br>
9: standalone</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;BUSINESS_STATUS&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;BUSINESS_STATUS&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>IND_BYTE</strong>: Contains "number of" info.  (# beds for nursing homes, # rooms for hotels)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;IND_BYTE&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>YEAR_EST</strong>: Year the business began operating</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;YEAR_EST&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>OFFICE_SIZE_CODE</strong>: Number of professionals per office with the same phone number<br>
Value labels:<br>
A: 1<br>
B: 2<br>
C: 3<br>
D: 4<br>
E: 5-9<br>
F: 10+</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;OFFICE_SIZE_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;OFFICE_SIZE_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>HOLDING_STATUS</strong>: Indicates if company is a public company, private company, or a branch</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;HOLDING_STATUS&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;HOLDING_STATUS&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ABI</strong>: Also known as iusa number, abi number, infogroup number or location number, this provides a unique identifier for each business in the infogroup business database</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;ABI&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SUBSIDIARY_NUMBER</strong>: The subsidiary parent number identifies the business as a regional or subsidiary headquarters for a corporate family. the subsidiary will always have a parent and may or may not have branches assigned to it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SUBSIDIARY_NUMBER&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PARENT_NUMBER</strong>: The parent number identifies the corporate parent of the business and also serves as the abi number for the headquarters site of the parent.  since all location of a business have the same ultimate parent number, this field provides corporate ownwership linkage infomration.  this iinformation is not collected or maintained for the types organiation for wich ownership is ambiguous.  churches and schools, in particular, are not linked in the file for this reason</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;PARENT_NUMBER&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PARENT_EMPLOYEES</strong>: Parent actual employee size refers to the parent abi record only</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;PARENT_EMPLOYEES&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PARENT_SALES</strong>: Parent actual sales refers to the parent abi record only</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;PARENT_SALES&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PARENT_EMPLOYEES_CODE</strong>: Parent employee code refers to the parent abi record only<br>
Value labels:<br>
A: 1-4<br>
B: 5-9<br>
C: 10-19<br>
D: 20-49<br>
E: 50-99<br>
F: 100-249<br>
G: 250-499<br>
H: 500-999<br>
I: 1000-4999<br>
J: 5000-9999<br>
K: 10000-</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;PARENT_EMPLOYEES_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;PARENT_EMPLOYEES_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PARENT_SALES_CODE</strong>: Parent sales code refers to the parent abi records only<br>
Value labels:<br>
A: 1-499<br>
B: 500-999<br>
C: 1000-2499<br>
D: 2500-4999<br>
E: 5000-9999<br>
F: 10000-19999<br>
G: 20000-49999<br>
H: 50000-99999<br>
I: 100000-499999<br>
J: 500000-999999<br>
K: 1000000+</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;PARENT_SALES_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;PARENT_SALES_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>SITE_NUMBER</strong>: Designates related business at one site, identifying the primary business.  if abi# and site# are the same, then the record is primary business at the site.  if abi# and site# are different, then the record is a secondary business at the site.  determined through relationships between multiple data elements.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;SITE_NUMBER&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>ADDRESS_TYPE</strong>: Indicates if type of address<br>
Value labels:<br>
F: Firm<br>
G: General delivery<br>
H: High-rise<br>
M: Military<br>
P: Post office box<br>
R: Rural route or hwy contract<br>
S: Street<br>
N: Unknown<br>
: No match to Zip4</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;ADDRESS_TYPE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;ADDRESS_TYPE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>CENSUS_TRACT</strong>: Identifies a small geographic area for the purpose of collecting and compiling population and housing data.  census tracts are unique only within census county, and census counties are unique only within census state.</p>
<p>Special value "000000" - missing?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;CENSUS_TRACT&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;000000&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>CENSUS_BLOCK</strong>: Bgs are subdivisions of census tracts and unique only within a specific census tract.  census tracts/block groups are assigned to address records via a geocoding process.</p>
<p>Special value "0" - missing?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;CENSUS_BLOCK&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LATITUDE</strong>: Parcel level assigned via point geo coding.  half of a pair of coordinates (the other being longitude)  provided in a formatted value, with decimals or a negative sign. not available in puerto rico &amp; virgin island.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>LONGITUDE</strong>: Parcel level assigned via point geo coding.  note: longitudes are negatives values in the western hemisphere.  provided in its formatted value, with decimals or a negative sign. not available in puerto rico &amp; virigin island</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;LONGITUDE&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>MATCH_CODE</strong>: Parcel level match code of the business location.<br>
Value labels:<br>
0: Site level<br>
2: Zip+2 centroid<br>
4: Zip+4 centroid<br>
P: Parcel<br>
X: Zip centroid</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;MATCH_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;MATCH_CODE&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>CBSA_CODE</strong>: Core bases statistical area (expanded msa code)</p>
<p>Special value "00000"</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;CBSA_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;00000&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>CBSA_LEVEL</strong>: Indicates if an area is a micropolitan or metropolitan area<br>
Value labels:<br>
1: Micropolitan<br>
2: Metropolitan</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;CBSA_LEVEL&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;CBSA_LEVEL&#39;</span><span class="p">)[</span><span class="s1">&#39;enum&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>CSA_CODE</strong>: Adjoining cbsa's.  combination of metro and micro areas</p>
<p>Special value "000".</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;CSA_CODE&#39;</span><span class="p">,</span> <span class="n">count_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;000&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>FIPS_CODE</strong>: First 2 bytes = state code, last 3 bytes = county code (location)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">describe_variable</span><span class="p">(</span><span class="s1">&#39;FIPS_CODE&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Nonregular-variables">Nonregular variables<a class="anchor-link" href="#Nonregular-variables"> </a></h2><p>The following variables are only available in select years.</p>
<ul>
<li>...</li>
</ul>
<p>Population code exists for all years, but coding changes after 2015.</p>
<p><strong>POPULATION_CODE</strong>: The code for the resident population of the city in which the business is located, according to rand mcnally. some assignments can vary within a ciyt, such as when cities cross county lines. to maintain this granularity, the actual assignment is done at a zip level.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Validation-of-geographic-variables">Validation of geographic variables<a class="anchor-link" href="#Validation-of-geographic-variables"> </a></h1><p>Geographic variables</p>
<ul>
<li>ADDRESS: historical address</li>
<li>CITY: historical address city</li>
<li>STATE: historical address state</li>
<li>ZIP: historical address zip code</li>
<li>ZIP4: historical address zip code zip + 4</li>
<li>COUNTY_CODE: county code based upon location address/zip4 (postal)</li>
<li>AREA_CODE: area code of business</li>
<li>ADDRESS_TYPE: indicates if type of address. "F": "Firm", "G": "General delivery", "H": "High-rise", "M": "Military", "P": "Post office box", "R": "Rural route or hwy contract", "S": "Street", "N": "Unknown", "": "No match to Zip4".</li>
<li>CENSUS_TRACT: identifies a small geographic area for the purpose of collecting and compiling population and housing data.  census tracts are unique only within census county, and census counties are unique only within census state.  </li>
<li>CENSUS_BLOCK: bgs are subdivisions of census tracts and unique only within a specific census tract.  census tracts/block groups are assigned to address records via a geocoding process.</li>
<li>LATITUDE: parcel level assigned via point geo coding.  half of a pair of coordinates (the other being longitude)  provided in a formatted value, with decimals or a negative sign. not available in puerto rico &amp; virgin island.</li>
<li>LONGITUDE: parcel level assigned via point geo coding.  note: longitudes are negatives values in the western hemisphere.  provided in its formatted value, with decimals or a negative sign. not available in puerto rico &amp; virigin island</li>
<li>MATCH_CODE: parcel level match code of the business location. "0": "Site level", "2": "Zip+2 centroid", "4": "Zip+4 centroid", "P": "Parcel", "X": "Zip centroid".</li>
<li>CBSA_CODE: core bases statistical area (expanded msa code)</li>
<li>CBSA_LEVEL: indicates if an area is a micropolitan or metropolitan area. "1": "Micropolitan", "2": "Metropolitan"</li>
<li>CSA_CODE: adjoining cbsa's.  combination of metro and micro areas</li>
<li>FIPS_CODE: first 2 bytes = state code, last 3 bytes = county code (location)</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geo_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ADDRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;CITY&#39;</span><span class="p">,</span> <span class="s1">&#39;STATE&#39;</span><span class="p">,</span> <span class="s1">&#39;ZIP&#39;</span><span class="p">,</span> <span class="s1">&#39;ZIP4&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTY_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;AREA_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;ADDRESS_TYPE&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;CENSUS_TRACT&#39;</span><span class="p">,</span> <span class="s1">&#39;CENSUS_BLOCK&#39;</span><span class="p">,</span> <span class="s1">&#39;LATITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;MATCH_CODE&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;CBSA_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;CBSA_LEVEL&#39;</span><span class="p">,</span> <span class="s1">&#39;CSA_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;FIPS_CODE&#39;</span><span class="p">]</span>
<span class="n">total_count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">isna_count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">other_count</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1997</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">get_df</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">geo_cols</span><span class="p">)</span>

    <span class="n">total_count</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">isna_count</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">geo_cols</span><span class="p">:</span>
        <span class="n">isna_count</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">other_count</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">other_count</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="s1">&#39;ADDRESS_TYPE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ADDRESS_TYPE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">other_count</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="s1">&#39;CENSUS_TRACT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CENSUS_TRACT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># is 000000 a valid tract id?</span>
    <span class="n">other_count</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="s1">&#39;CENSUS_BLOCK&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CENSUS_BLOCK&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># is 0 a valid block id?</span>
    <span class="n">other_count</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="s1">&#39;CBSA_CODE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CBSA_CODE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">other_count</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="s1">&#39;CSA_CODE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CSA_CODE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="STATE,-COUNTY_CODE-and-FIPS_CODE">STATE, COUNTY_CODE and FIPS_CODE<a class="anchor-link" href="#STATE,-COUNTY_CODE-and-FIPS_CODE"> </a></h2><ul>
<li>STATE is never missing</li>
<li>Tiny fraction (0.0001%) have missing COUNTY_CODE or FIPS_CODE</li>
<li>Until 2012, about 2% have inconsistent codes, and only a few after that</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state_fips_map</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;AL&#39;</span><span class="p">:</span><span class="s1">&#39;01&#39;</span><span class="p">,</span>
<span class="s1">&#39;AK&#39;</span><span class="p">:</span><span class="s1">&#39;02&#39;</span><span class="p">,</span>
<span class="s1">&#39;AS&#39;</span><span class="p">:</span><span class="s1">&#39;60&#39;</span><span class="p">,</span>
<span class="s1">&#39;AZ&#39;</span><span class="p">:</span><span class="s1">&#39;04&#39;</span><span class="p">,</span>
<span class="s1">&#39;AR&#39;</span><span class="p">:</span><span class="s1">&#39;05&#39;</span><span class="p">,</span>
<span class="s1">&#39;CA&#39;</span><span class="p">:</span><span class="s1">&#39;06&#39;</span><span class="p">,</span>
<span class="s1">&#39;CO&#39;</span><span class="p">:</span><span class="s1">&#39;08&#39;</span><span class="p">,</span>
<span class="s1">&#39;CT&#39;</span><span class="p">:</span><span class="s1">&#39;09&#39;</span><span class="p">,</span>
<span class="s1">&#39;DE&#39;</span><span class="p">:</span><span class="s1">&#39;10&#39;</span><span class="p">,</span>
<span class="s1">&#39;DC&#39;</span><span class="p">:</span><span class="s1">&#39;11&#39;</span><span class="p">,</span>
<span class="s1">&#39;FL&#39;</span><span class="p">:</span><span class="s1">&#39;12&#39;</span><span class="p">,</span>
<span class="s1">&#39;FM&#39;</span><span class="p">:</span><span class="s1">&#39;64&#39;</span><span class="p">,</span>
<span class="s1">&#39;GA&#39;</span><span class="p">:</span><span class="s1">&#39;13&#39;</span><span class="p">,</span>
<span class="s1">&#39;GU&#39;</span><span class="p">:</span><span class="s1">&#39;66&#39;</span><span class="p">,</span>
<span class="s1">&#39;HI&#39;</span><span class="p">:</span><span class="s1">&#39;15&#39;</span><span class="p">,</span>
<span class="s1">&#39;ID&#39;</span><span class="p">:</span><span class="s1">&#39;16&#39;</span><span class="p">,</span>
<span class="s1">&#39;IL&#39;</span><span class="p">:</span><span class="s1">&#39;17&#39;</span><span class="p">,</span>
<span class="s1">&#39;IN&#39;</span><span class="p">:</span><span class="s1">&#39;18&#39;</span><span class="p">,</span>
<span class="s1">&#39;IA&#39;</span><span class="p">:</span><span class="s1">&#39;19&#39;</span><span class="p">,</span>
<span class="s1">&#39;KS&#39;</span><span class="p">:</span><span class="s1">&#39;20&#39;</span><span class="p">,</span>
<span class="s1">&#39;KY&#39;</span><span class="p">:</span><span class="s1">&#39;21&#39;</span><span class="p">,</span>
<span class="s1">&#39;LA&#39;</span><span class="p">:</span><span class="s1">&#39;22&#39;</span><span class="p">,</span>
<span class="s1">&#39;ME&#39;</span><span class="p">:</span><span class="s1">&#39;23&#39;</span><span class="p">,</span>
<span class="s1">&#39;MH&#39;</span><span class="p">:</span><span class="s1">&#39;68&#39;</span><span class="p">,</span>
<span class="s1">&#39;MD&#39;</span><span class="p">:</span><span class="s1">&#39;24&#39;</span><span class="p">,</span>
<span class="s1">&#39;MA&#39;</span><span class="p">:</span><span class="s1">&#39;25&#39;</span><span class="p">,</span>
<span class="s1">&#39;MI&#39;</span><span class="p">:</span><span class="s1">&#39;26&#39;</span><span class="p">,</span>
<span class="s1">&#39;MN&#39;</span><span class="p">:</span><span class="s1">&#39;27&#39;</span><span class="p">,</span>
<span class="s1">&#39;MS&#39;</span><span class="p">:</span><span class="s1">&#39;28&#39;</span><span class="p">,</span>
<span class="s1">&#39;MO&#39;</span><span class="p">:</span><span class="s1">&#39;29&#39;</span><span class="p">,</span>
<span class="s1">&#39;MT&#39;</span><span class="p">:</span><span class="s1">&#39;30&#39;</span><span class="p">,</span>
<span class="s1">&#39;NE&#39;</span><span class="p">:</span><span class="s1">&#39;31&#39;</span><span class="p">,</span>
<span class="s1">&#39;NV&#39;</span><span class="p">:</span><span class="s1">&#39;32&#39;</span><span class="p">,</span>
<span class="s1">&#39;NH&#39;</span><span class="p">:</span><span class="s1">&#39;33&#39;</span><span class="p">,</span>
<span class="s1">&#39;NJ&#39;</span><span class="p">:</span><span class="s1">&#39;34&#39;</span><span class="p">,</span>
<span class="s1">&#39;NM&#39;</span><span class="p">:</span><span class="s1">&#39;35&#39;</span><span class="p">,</span>
<span class="s1">&#39;NY&#39;</span><span class="p">:</span><span class="s1">&#39;36&#39;</span><span class="p">,</span>
<span class="s1">&#39;NC&#39;</span><span class="p">:</span><span class="s1">&#39;37&#39;</span><span class="p">,</span>
<span class="s1">&#39;ND&#39;</span><span class="p">:</span><span class="s1">&#39;38&#39;</span><span class="p">,</span>
<span class="s1">&#39;MP&#39;</span><span class="p">:</span><span class="s1">&#39;69&#39;</span><span class="p">,</span>
<span class="s1">&#39;OH&#39;</span><span class="p">:</span><span class="s1">&#39;39&#39;</span><span class="p">,</span>
<span class="s1">&#39;OK&#39;</span><span class="p">:</span><span class="s1">&#39;40&#39;</span><span class="p">,</span>
<span class="s1">&#39;OR&#39;</span><span class="p">:</span><span class="s1">&#39;41&#39;</span><span class="p">,</span>
<span class="s1">&#39;PW&#39;</span><span class="p">:</span><span class="s1">&#39;70&#39;</span><span class="p">,</span>
<span class="s1">&#39;PA&#39;</span><span class="p">:</span><span class="s1">&#39;42&#39;</span><span class="p">,</span>
<span class="s1">&#39;PR&#39;</span><span class="p">:</span><span class="s1">&#39;72&#39;</span><span class="p">,</span>
<span class="s1">&#39;RI&#39;</span><span class="p">:</span><span class="s1">&#39;44&#39;</span><span class="p">,</span>
<span class="s1">&#39;SC&#39;</span><span class="p">:</span><span class="s1">&#39;45&#39;</span><span class="p">,</span>
<span class="s1">&#39;SD&#39;</span><span class="p">:</span><span class="s1">&#39;46&#39;</span><span class="p">,</span>
<span class="s1">&#39;TN&#39;</span><span class="p">:</span><span class="s1">&#39;47&#39;</span><span class="p">,</span>
<span class="s1">&#39;TX&#39;</span><span class="p">:</span><span class="s1">&#39;48&#39;</span><span class="p">,</span>
<span class="s1">&#39;UM&#39;</span><span class="p">:</span><span class="s1">&#39;74&#39;</span><span class="p">,</span>
<span class="s1">&#39;UT&#39;</span><span class="p">:</span><span class="s1">&#39;49&#39;</span><span class="p">,</span>
<span class="s1">&#39;VT&#39;</span><span class="p">:</span><span class="s1">&#39;50&#39;</span><span class="p">,</span>
<span class="s1">&#39;VA&#39;</span><span class="p">:</span><span class="s1">&#39;51&#39;</span><span class="p">,</span>
<span class="s1">&#39;VI&#39;</span><span class="p">:</span><span class="s1">&#39;78&#39;</span><span class="p">,</span>
<span class="s1">&#39;WA&#39;</span><span class="p">:</span><span class="s1">&#39;53&#39;</span><span class="p">,</span>
<span class="s1">&#39;WV&#39;</span><span class="p">:</span><span class="s1">&#39;54&#39;</span><span class="p">,</span>
<span class="s1">&#39;WI&#39;</span><span class="p">:</span><span class="s1">&#39;55&#39;</span><span class="p">,</span>
<span class="s1">&#39;WY&#39;</span><span class="p">:</span><span class="s1">&#39;56&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">resources</span><span class="o">.</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">]</span><span class="o">/</span><span class="s1">&#39;tmp/geo_valid.log&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># logging.basicConfig(stream=sys.stdout, level=logging.INFO, format=&#39;%(message)s&#39;, force=True)</span>
<span class="n">crosstabs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1997</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">get_df</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;STATE&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTY_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;FIPS_CODE&#39;</span><span class="p">])</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;_STATE_CODE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_fips_map</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">state_isna</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;STATE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="n">state_isna</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;STATE is NA&#39;</span>
    <span class="n">county_isna</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;COUNTY_CODE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="n">county_isna</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;COUNTY_CODE is NA&#39;</span>
    <span class="n">fips_isna</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">FIPS_CODE</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="n">fips_isna</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FIPS_CODE is NA&#39;</span>
    <span class="n">county_eq_fips</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;COUNTY_CODE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;FIPS_CODE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
    <span class="n">county_eq_fips</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;COUNTY_CODE consistent with FIPS_CODE&#39;</span>
    <span class="n">state_eq_fips</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;_STATE_CODE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;FIPS_CODE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">state_eq_fips</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;STATE consistent with FIPS_CODE&#39;</span>

    <span class="n">crosstab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">([</span><span class="n">state_isna</span><span class="p">,</span> <span class="n">county_isna</span><span class="p">,</span> <span class="n">fips_isna</span><span class="p">],</span> <span class="p">[</span><span class="n">county_eq_fips</span><span class="p">,</span> <span class="n">state_eq_fips</span><span class="p">])</span>
    <span class="n">crosstabs</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">crosstab</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    ---- </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1"> ----</span>
<span class="s1">    STATE, COUNTY_CODE and FIPS_CODE consistency</span>

<span class="s1">    </span><span class="si">{</span><span class="n">crosstab</span><span class="si">}</span><span class="s1"></span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">crosstabs</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ct</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="p">(</span><span class="n">ct</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()]</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ct</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>COUNTY_CODE is NA</th>
      <th colspan="4" halign="left">False</th>
      <th colspan="2" halign="left">True</th>
    </tr>
    <tr>
      <th>FIPS_CODE is NA</th>
      <th colspan="3" halign="left">False</th>
      <th>True</th>
      <th>False</th>
      <th>True</th>
    </tr>
    <tr>
      <th>COUNTY_CODE consistent with FIPS_CODE</th>
      <th colspan="2" halign="left">False</th>
      <th>True</th>
      <th>False</th>
      <th>False</th>
      <th>False</th>
    </tr>
    <tr>
      <th>STATE consistent with FIPS_CODE</th>
      <th>False</th>
      <th>True</th>
      <th>True</th>
      <th>False</th>
      <th>True</th>
      <th>False</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1997</th>
      <td>2</td>
      <td>305967</td>
      <td>10957899</td>
      <td>44</td>
      <td>9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>3</td>
      <td>290518</td>
      <td>10483648</td>
      <td>42</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>2</td>
      <td>207727</td>
      <td>10812277</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>2</td>
      <td>211052</td>
      <td>10958160</td>
      <td>62</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>0</td>
      <td>247133</td>
      <td>12302142</td>
      <td>109</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>0</td>
      <td>254970</td>
      <td>12593895</td>
      <td>84</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2003</th>
      <td>0</td>
      <td>235969</td>
      <td>12506444</td>
      <td>71</td>
      <td>414</td>
      <td>282</td>
    </tr>
    <tr>
      <th>2004</th>
      <td>0</td>
      <td>234525</td>
      <td>12381994</td>
      <td>13</td>
      <td>1</td>
      <td>191</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>0</td>
      <td>249535</td>
      <td>12946719</td>
      <td>12</td>
      <td>1</td>
      <td>182</td>
    </tr>
    <tr>
      <th>2006</th>
      <td>0</td>
      <td>253505</td>
      <td>13096764</td>
      <td>11</td>
      <td>0</td>
      <td>170</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>0</td>
      <td>264006</td>
      <td>13437223</td>
      <td>14</td>
      <td>0</td>
      <td>133</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>0</td>
      <td>269040</td>
      <td>13618628</td>
      <td>11</td>
      <td>0</td>
      <td>124</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>0</td>
      <td>259188</td>
      <td>13409783</td>
      <td>11</td>
      <td>0</td>
      <td>99</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>0</td>
      <td>268004</td>
      <td>13566168</td>
      <td>10</td>
      <td>0</td>
      <td>98</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>0</td>
      <td>254914</td>
      <td>13213594</td>
      <td>14</td>
      <td>1</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>0</td>
      <td>6911</td>
      <td>14708383</td>
      <td>12</td>
      <td>0</td>
      <td>62</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>0</td>
      <td>4401</td>
      <td>15949852</td>
      <td>11</td>
      <td>37</td>
      <td>57</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>0</td>
      <td>2914</td>
      <td>15913903</td>
      <td>9</td>
      <td>39</td>
      <td>38</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>0</td>
      <td>2527</td>
      <td>15626365</td>
      <td>8</td>
      <td>0</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>0</td>
      <td>831</td>
      <td>15715770</td>
      <td>7</td>
      <td>4</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>0</td>
      <td>1210</td>
      <td>14825920</td>
      <td>5</td>
      <td>2</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ctf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">ctf</span><span class="p">[</span><span class="s1">&#39;Valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)]</span>
<span class="n">ctf</span><span class="p">[</span><span class="s1">&#39;Missing COUNTY_CODE or FIPS_CODE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ct</span><span class="p">[(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,)]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ctf</span><span class="p">[</span><span class="s1">&#39;Inconsistent codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">ctf</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_series_equal</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ctf</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ctf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ctf</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">ctf</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctf</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ctf</span> <span class="o">=</span> <span class="n">ctf</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ctf</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
</style><table id="T_53469c30_e180_11ea_bb77_877e95c1f2c9" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Valid</th>        <th class="col_heading level0 col1" >Missing COUNTY_CODE or FIPS_CODE</th>        <th class="col_heading level0 col2" >Inconsistent codes</th>        <th class="col_heading level0 col3" >Total</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row0" class="row_heading level0 row0" >1997</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row0_col0" class="data row0 col0" >10,957,899</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row0_col1" class="data row0 col1" >53</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row0_col2" class="data row0 col2" >305,969</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row0_col3" class="data row0 col3" >11,263,921</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row1" class="row_heading level0 row1" >1998</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row1_col0" class="data row1 col0" >10,483,648</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row1_col1" class="data row1 col1" >42</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row1_col2" class="data row1 col2" >290,521</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row1_col3" class="data row1 col3" >10,774,211</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row2" class="row_heading level0 row2" >1999</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row2_col0" class="data row2 col0" >10,812,277</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row2_col1" class="data row2 col1" >60</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row2_col2" class="data row2 col2" >207,729</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row2_col3" class="data row2 col3" >11,020,066</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row3" class="row_heading level0 row3" >2000</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row3_col0" class="data row3 col0" >10,958,160</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row3_col1" class="data row3 col1" >62</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row3_col2" class="data row3 col2" >211,054</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row3_col3" class="data row3 col3" >11,169,276</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row4" class="row_heading level0 row4" >2001</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row4_col0" class="data row4 col0" >12,302,142</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row4_col1" class="data row4 col1" >109</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row4_col2" class="data row4 col2" >247,133</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row4_col3" class="data row4 col3" >12,549,384</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row5" class="row_heading level0 row5" >2002</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row5_col0" class="data row5 col0" >12,593,895</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row5_col1" class="data row5 col1" >84</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row5_col2" class="data row5 col2" >254,970</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row5_col3" class="data row5 col3" >12,848,949</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row6" class="row_heading level0 row6" >2003</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row6_col0" class="data row6 col0" >12,506,444</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row6_col1" class="data row6 col1" >767</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row6_col2" class="data row6 col2" >235,969</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row6_col3" class="data row6 col3" >12,743,180</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row7" class="row_heading level0 row7" >2004</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row7_col0" class="data row7 col0" >12,381,994</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row7_col1" class="data row7 col1" >205</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row7_col2" class="data row7 col2" >234,525</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row7_col3" class="data row7 col3" >12,616,724</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row8" class="row_heading level0 row8" >2005</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row8_col0" class="data row8 col0" >12,946,719</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row8_col1" class="data row8 col1" >195</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row8_col2" class="data row8 col2" >249,535</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row8_col3" class="data row8 col3" >13,196,449</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row9" class="row_heading level0 row9" >2006</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row9_col0" class="data row9 col0" >13,096,764</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row9_col1" class="data row9 col1" >181</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row9_col2" class="data row9 col2" >253,505</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row9_col3" class="data row9 col3" >13,350,450</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row10" class="row_heading level0 row10" >2007</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row10_col0" class="data row10 col0" >13,437,223</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row10_col1" class="data row10 col1" >147</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row10_col2" class="data row10 col2" >264,006</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row10_col3" class="data row10 col3" >13,701,376</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row11" class="row_heading level0 row11" >2008</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row11_col0" class="data row11 col0" >13,618,628</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row11_col1" class="data row11 col1" >135</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row11_col2" class="data row11 col2" >269,040</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row11_col3" class="data row11 col3" >13,887,803</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row12" class="row_heading level0 row12" >2009</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row12_col0" class="data row12 col0" >13,409,783</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row12_col1" class="data row12 col1" >110</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row12_col2" class="data row12 col2" >259,188</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row12_col3" class="data row12 col3" >13,669,081</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row13" class="row_heading level0 row13" >2010</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row13_col0" class="data row13 col0" >13,566,168</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row13_col1" class="data row13 col1" >108</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row13_col2" class="data row13 col2" >268,004</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row13_col3" class="data row13 col3" >13,834,280</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row14" class="row_heading level0 row14" >2011</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row14_col0" class="data row14 col0" >13,213,594</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row14_col1" class="data row14 col1" >105</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row14_col2" class="data row14 col2" >254,914</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row14_col3" class="data row14 col3" >13,468,613</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row15" class="row_heading level0 row15" >2012</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row15_col0" class="data row15 col0" >14,708,383</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row15_col1" class="data row15 col1" >74</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row15_col2" class="data row15 col2" >6,911</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row15_col3" class="data row15 col3" >14,715,368</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row16" class="row_heading level0 row16" >2013</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row16_col0" class="data row16 col0" >15,949,852</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row16_col1" class="data row16 col1" >105</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row16_col2" class="data row16 col2" >4,401</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row16_col3" class="data row16 col3" >15,954,358</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row17" class="row_heading level0 row17" >2014</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row17_col0" class="data row17 col0" >15,913,903</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row17_col1" class="data row17 col1" >86</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row17_col2" class="data row17 col2" >2,914</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row17_col3" class="data row17 col3" >15,916,903</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row18" class="row_heading level0 row18" >2015</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row18_col0" class="data row18 col0" >15,626,365</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row18_col1" class="data row18 col1" >24</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row18_col2" class="data row18 col2" >2,527</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row18_col3" class="data row18 col3" >15,628,916</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row19" class="row_heading level0 row19" >2016</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row19_col0" class="data row19 col0" >15,715,770</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row19_col1" class="data row19 col1" >32</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row19_col2" class="data row19 col2" >831</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row19_col3" class="data row19 col3" >15,716,633</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row20" class="row_heading level0 row20" >2017</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row20_col0" class="data row20 col0" >14,825,920</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row20_col1" class="data row20 col1" >22</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row20_col2" class="data row20 col2" >1,210</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row20_col3" class="data row20 col3" >14,827,152</td>
            </tr>
            <tr>
                        <th id="T_53469c30_e180_11ea_bb77_877e95c1f2c9level0_row21" class="row_heading level0 row21" >Total</th>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row21_col0" class="data row21 col0" >279,025,531</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row21_col1" class="data row21 col1" >2,706</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row21_col2" class="data row21 col2" >3,824,856</td>
                        <td id="T_53469c30_e180_11ea_bb77_877e95c1f2c9row21_col3" class="data row21 col3" >282,853,093</td>
            </tr>
    </tbody></table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ctfr</span> <span class="o">=</span> <span class="n">ctf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ctfr</span><span class="p">:</span>
    <span class="n">ctfr</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="n">ctfr</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span>
<span class="n">ctfr</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3%}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
</style><table id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Valid</th>        <th class="col_heading level0 col1" >Missing COUNTY_CODE or FIPS_CODE</th>        <th class="col_heading level0 col2" >Inconsistent codes</th>        <th class="col_heading level0 col3" >Total</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row0" class="row_heading level0 row0" >1997</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row0_col0" class="data row0 col0" >97.283%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row0_col1" class="data row0 col1" >0.000%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row0_col2" class="data row0 col2" >2.716%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row0_col3" class="data row0 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row1" class="row_heading level0 row1" >1998</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row1_col0" class="data row1 col0" >97.303%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row1_col1" class="data row1 col1" >0.000%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row1_col2" class="data row1 col2" >2.696%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row1_col3" class="data row1 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row2" class="row_heading level0 row2" >1999</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row2_col0" class="data row2 col0" >98.114%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row2_col1" class="data row2 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row2_col2" class="data row2 col2" >1.885%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row2_col3" class="data row2 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row3" class="row_heading level0 row3" >2000</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row3_col0" class="data row3 col0" >98.110%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row3_col1" class="data row3 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row3_col2" class="data row3 col2" >1.890%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row3_col3" class="data row3 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row4" class="row_heading level0 row4" >2001</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row4_col0" class="data row4 col0" >98.030%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row4_col1" class="data row4 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row4_col2" class="data row4 col2" >1.969%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row4_col3" class="data row4 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row5" class="row_heading level0 row5" >2002</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row5_col0" class="data row5 col0" >98.015%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row5_col1" class="data row5 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row5_col2" class="data row5 col2" >1.984%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row5_col3" class="data row5 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row6" class="row_heading level0 row6" >2003</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row6_col0" class="data row6 col0" >98.142%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row6_col1" class="data row6 col1" >0.006%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row6_col2" class="data row6 col2" >1.852%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row6_col3" class="data row6 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row7" class="row_heading level0 row7" >2004</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row7_col0" class="data row7 col0" >98.140%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row7_col1" class="data row7 col1" >0.002%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row7_col2" class="data row7 col2" >1.859%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row7_col3" class="data row7 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row8" class="row_heading level0 row8" >2005</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row8_col0" class="data row8 col0" >98.108%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row8_col1" class="data row8 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row8_col2" class="data row8 col2" >1.891%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row8_col3" class="data row8 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row9" class="row_heading level0 row9" >2006</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row9_col0" class="data row9 col0" >98.100%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row9_col1" class="data row9 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row9_col2" class="data row9 col2" >1.899%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row9_col3" class="data row9 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row10" class="row_heading level0 row10" >2007</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row10_col0" class="data row10 col0" >98.072%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row10_col1" class="data row10 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row10_col2" class="data row10 col2" >1.927%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row10_col3" class="data row10 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row11" class="row_heading level0 row11" >2008</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row11_col0" class="data row11 col0" >98.062%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row11_col1" class="data row11 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row11_col2" class="data row11 col2" >1.937%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row11_col3" class="data row11 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row12" class="row_heading level0 row12" >2009</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row12_col0" class="data row12 col0" >98.103%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row12_col1" class="data row12 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row12_col2" class="data row12 col2" >1.896%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row12_col3" class="data row12 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row13" class="row_heading level0 row13" >2010</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row13_col0" class="data row13 col0" >98.062%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row13_col1" class="data row13 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row13_col2" class="data row13 col2" >1.937%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row13_col3" class="data row13 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row14" class="row_heading level0 row14" >2011</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row14_col0" class="data row14 col0" >98.107%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row14_col1" class="data row14 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row14_col2" class="data row14 col2" >1.893%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row14_col3" class="data row14 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row15" class="row_heading level0 row15" >2012</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row15_col0" class="data row15 col0" >99.953%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row15_col1" class="data row15 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row15_col2" class="data row15 col2" >0.047%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row15_col3" class="data row15 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row16" class="row_heading level0 row16" >2013</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row16_col0" class="data row16 col0" >99.972%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row16_col1" class="data row16 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row16_col2" class="data row16 col2" >0.028%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row16_col3" class="data row16 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row17" class="row_heading level0 row17" >2014</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row17_col0" class="data row17 col0" >99.981%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row17_col1" class="data row17 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row17_col2" class="data row17 col2" >0.018%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row17_col3" class="data row17 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row18" class="row_heading level0 row18" >2015</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row18_col0" class="data row18 col0" >99.984%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row18_col1" class="data row18 col1" >0.000%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row18_col2" class="data row18 col2" >0.016%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row18_col3" class="data row18 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row19" class="row_heading level0 row19" >2016</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row19_col0" class="data row19 col0" >99.995%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row19_col1" class="data row19 col1" >0.000%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row19_col2" class="data row19 col2" >0.005%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row19_col3" class="data row19 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row20" class="row_heading level0 row20" >2017</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row20_col0" class="data row20 col0" >99.992%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row20_col1" class="data row20 col1" >0.000%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row20_col2" class="data row20 col2" >0.008%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row20_col3" class="data row20 col3" >100.000%</td>
            </tr>
            <tr>
                        <th id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9level0_row21" class="row_heading level0 row21" >Total</th>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row21_col0" class="data row21 col0" >98.647%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row21_col1" class="data row21 col1" >0.001%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row21_col2" class="data row21 col2" >1.352%</td>
                        <td id="T_8514bbee_e17f_11ea_bb77_877e95c1f2c9row21_col3" class="data row21 col3" >100.000%</td>
            </tr>
    </tbody></table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CBSA_CODE-and-CBSA_LEVEL">CBSA_CODE and CBSA_LEVEL<a class="anchor-link" href="#CBSA_CODE-and-CBSA_LEVEL"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h1>
</div>
</div>
</div>
</div>
 

